# Octoprint-stats-scraper

Instructions to myself on how I set up this scraper to pull from the json file generated by the [octoprint-stats](https://github.com/AlexVerrico/octoprint-stats) plugin and upload results to a Google spreadsheet.

## Overview

After installing the `octorprint-stats` plugin (I am using a forked version), a JSON file will be generated in the octoprint data directory (in my case, `$HOME/.octoprint/data/octoprint_stats.json`). The goal of this program is to scrape that and upload the useful data into a Google spreadsheet in Google Drive.

I used [gspread](https://docs.gspread.org/en/v6.0.0/) to authenticate and upload the data to Google Drive. This included a long laborious process of having GCP create an API Key for a service account. Luckily, you just download a json file, place it in the gspread configuration location (`$HOME/.config/gspread`), and the python package deals with the rest. You'll have to "share" the spreadsheet with the associated service account email.

The program is actually pretty simple, so I'll myself re-read it instead of going into it too deeply, but worth noting is how I am currently having this scrape the source file repeatedly. I am using a cron job to run this once per minute:

```
$ crontab -e
```

And paste the following job:

```
* * * * * <PYTHON INSTALLATION>  $HOME/octoprint-stats-scraper/upload.py >> $HOME/octoprint-stats-scraper/logs/upload.logfile 2>&1
```
